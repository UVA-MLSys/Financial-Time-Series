Running for model:DLinear
NVIDIA GeForce GTX 1080 Ti
Args in experiment: Namespace(test=False, seed=2024, result_path='results', disable_progress=True, root_path='./data', data_path='Crude_Oil.csv', features='M', n_features=5, target='OT', freq='d', no_scale=False, seq_len=96, label_len=48, pred_len=48, top_k=5, num_kernels=6, d_model=64, n_heads=4, e_layers=2, d_layers=1, d_ff=128, moving_avg=3, factor=1, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=0, down_sampling_window=1, down_sampling_method=None, seg_len=48, num_workers=10, itrs=3, itr_no=None, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, des=None, loss='MSE', lradj='type1', gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, dry_run=False, percent=100, model='DLinear', use_gpu=True, enc_in=5, dec_in=5, c_out=5, task_name='long_term_forecast')

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/DLinear_sl_96_pl_48/1

Experiment begins at 2024-09-06 09:33:03

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 3.35 s | Train Loss: 4.2694 Vali Loss: 1.4632
Validation loss decreased (inf --> 1.463193).  Saving model ...
Epoch: 2 | Time: 1.93 s | Train Loss: 3.7266 Vali Loss: 1.7007
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 1.59 s | Train Loss: 3.5835 Vali Loss: 1.7229
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 1.43 s | Train Loss: 3.5284 Vali Loss: 1.7231
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:33:14.
Model parameters: 9312
Total memory: 11165.2 MB
Allocated memory: 16.6 MB
Max allocated memory: 17.1 MB
Time per epoch: 2.7 sec.
Memory usage: Available 11165.2 MB, Allocated 16.6 MB, Max allocated 17.1 MB

Loading model from results/Crude_Oil/DLinear_sl_96_pl_48/1/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.0805, mae:0.83557
Upscaling data and removing negatives...
test -- mse:2.013e+09, mae:14717, rmsle: 0.34349 smape 11.577


>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/DLinear_sl_96_pl_48/2

Experiment begins at 2024-09-06 09:33:14

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 1.31 s | Train Loss: 4.3205 Vali Loss: 1.4137
Validation loss decreased (inf --> 1.413723).  Saving model ...
Epoch: 2 | Time: 1.33 s | Train Loss: 3.7494 Vali Loss: 1.6395
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 1.35 s | Train Loss: 3.6159 Vali Loss: 1.6983
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 1.42 s | Train Loss: 3.5361 Vali Loss: 1.711
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:33:20.
Model parameters: 9312
Total memory: 11165.2 MB
Allocated memory: 16.6 MB
Max allocated memory: 17.1 MB
Time per epoch: 1.5 sec.
Memory usage: Available 11165.2 MB, Allocated 16.6 MB, Max allocated 17.1 MB

Loading model from results/Crude_Oil/DLinear_sl_96_pl_48/2/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.0581, mae:0.83107
Upscaling data and removing negatives...
test -- mse:2.0074e+09, mae:14761, rmsle: 0.34247 smape 11.569


>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/DLinear_sl_96_pl_48/3

Experiment begins at 2024-09-06 09:33:20

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 1.75 s | Train Loss: 4.3228 Vali Loss: 1.4621
Validation loss decreased (inf --> 1.462088).  Saving model ...
Epoch: 2 | Time: 1.58 s | Train Loss: 3.7446 Vali Loss: 1.6572
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 1.42 s | Train Loss: 3.5943 Vali Loss: 1.7394
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 1.54 s | Train Loss: 3.5358 Vali Loss: 1.7358
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:33:27.
Model parameters: 9312
Total memory: 11165.2 MB
Allocated memory: 16.6 MB
Max allocated memory: 17.1 MB
Time per epoch: 1.7 sec.
Memory usage: Available 11165.2 MB, Allocated 16.6 MB, Max allocated 17.1 MB

Loading model from results/Crude_Oil/DLinear_sl_96_pl_48/3/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.0681, mae:0.83193
Upscaling data and removing negatives...
test -- mse:2.0102e+09, mae:14696, rmsle: 0.34324 smape 11.54

Running for model:PatchTST
NVIDIA GeForce GTX 1080 Ti
Args in experiment: Namespace(test=False, seed=2024, result_path='results', disable_progress=True, root_path='./data', data_path='Crude_Oil.csv', features='M', n_features=5, target='OT', freq='d', no_scale=False, seq_len=96, label_len=48, pred_len=48, top_k=5, num_kernels=6, d_model=64, n_heads=4, e_layers=2, d_layers=1, d_ff=128, moving_avg=3, factor=1, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=0, down_sampling_window=1, down_sampling_method=None, seg_len=48, num_workers=10, itrs=3, itr_no=None, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, des=None, loss='MSE', lradj='type1', gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, dry_run=False, percent=100, model='PatchTST', use_gpu=True, enc_in=5, dec_in=5, c_out=5, task_name='long_term_forecast')

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/PatchTST_sl_96_pl_48/1

Experiment begins at 2024-09-06 09:33:37

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 7.3 s | Train Loss: 3.8285 Vali Loss: 1.9251
Validation loss decreased (inf --> 1.925054).  Saving model ...
Epoch: 2 | Time: 2.62 s | Train Loss: 3.3152 Vali Loss: 2.3628
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 2.53 s | Train Loss: 2.9357 Vali Loss: 2.5125
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 2.49 s | Train Loss: 2.6875 Vali Loss: 2.2811
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:33:54.
Model parameters: 105008
Total memory: 11165.2 MB
Allocated memory: 19.3 MB
Max allocated memory: 35.1 MB
Time per epoch: 4.2 sec.
Memory usage: Available 11165.2 MB, Allocated 19.3 MB, Max allocated 35.1 MB

Loading model from results/Crude_Oil/PatchTST_sl_96_pl_48/1/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.3169, mae:0.88521
Upscaling data and removing negatives...
test -- mse:1.8883e+09, mae:15140, rmsle: 0.32754 smape 12.366


>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/PatchTST_sl_96_pl_48/2

Experiment begins at 2024-09-06 09:33:54

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 2.52 s | Train Loss: 3.8511 Vali Loss: 2.2146
Validation loss decreased (inf --> 2.214604).  Saving model ...
Epoch: 2 | Time: 2.45 s | Train Loss: 3.3449 Vali Loss: 1.8395
Validation loss decreased (2.214604 --> 1.839494).  Saving model ...
Epoch: 3 | Time: 2.63 s | Train Loss: 2.8928 Vali Loss: 2.1318
EarlyStopping counter: 1 out of 3
Epoch: 4 | Time: 2.51 s | Train Loss: 2.6028 Vali Loss: 2.416
EarlyStopping counter: 2 out of 3
Epoch: 5 | Time: 2.55 s | Train Loss: 2.2566 Vali Loss: 2.1612
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:34:08.
Model parameters: 105008
Total memory: 11165.2 MB
Allocated memory: 19.3 MB
Max allocated memory: 35.1 MB
Time per epoch: 2.7 sec.
Memory usage: Available 11165.2 MB, Allocated 19.3 MB, Max allocated 35.1 MB

Loading model from results/Crude_Oil/PatchTST_sl_96_pl_48/2/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.1661, mae:0.85151
Upscaling data and removing negatives...
test -- mse:2.1364e+09, mae:16802, rmsle: 0.34776 smape 12.966


>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/PatchTST_sl_96_pl_48/3

Experiment begins at 2024-09-06 09:34:08

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 2.48 s | Train Loss: 3.8275 Vali Loss: 2.1127
Validation loss decreased (inf --> 2.112724).  Saving model ...
Epoch: 2 | Time: 2.56 s | Train Loss: 3.2967 Vali Loss: 1.9652
Validation loss decreased (2.112724 --> 1.965219).  Saving model ...
Epoch: 3 | Time: 2.59 s | Train Loss: 3.035 Vali Loss: 1.8047
Validation loss decreased (1.965219 --> 1.804712).  Saving model ...
Epoch: 4 | Time: 2.49 s | Train Loss: 2.7943 Vali Loss: 1.9537
EarlyStopping counter: 1 out of 3
Epoch: 5 | Time: 2.47 s | Train Loss: 2.4982 Vali Loss: 1.8393
EarlyStopping counter: 2 out of 3
Epoch: 6 | Time: 2.46 s | Train Loss: 2.1562 Vali Loss: 1.7411
Validation loss decreased (1.804712 --> 1.741109).  Saving model ...
Epoch: 7 | Time: 2.48 s | Train Loss: 2.0382 Vali Loss: 1.8309
EarlyStopping counter: 1 out of 3
Epoch: 8 | Time: 2.47 s | Train Loss: 1.992 Vali Loss: 1.8649
EarlyStopping counter: 2 out of 3
Epoch: 9 | Time: 2.5 s | Train Loss: 1.9885 Vali Loss: 1.8852
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:34:32.
Model parameters: 105008
Total memory: 11165.2 MB
Allocated memory: 19.3 MB
Max allocated memory: 35.1 MB
Time per epoch: 2.6 sec.
Memory usage: Available 11165.2 MB, Allocated 19.3 MB, Max allocated 35.1 MB

Loading model from results/Crude_Oil/PatchTST_sl_96_pl_48/3/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.7962, mae:0.99897
Upscaling data and removing negatives...
test -- mse:1.6758e+09, mae:13983, rmsle: 0.32351 smape 12.44

Running for model:TimesNet
NVIDIA GeForce GTX 1080 Ti
Args in experiment: Namespace(test=False, seed=2024, result_path='results', disable_progress=True, root_path='./data', data_path='Crude_Oil.csv', features='M', n_features=5, target='OT', freq='d', no_scale=False, seq_len=96, label_len=48, pred_len=48, top_k=5, num_kernels=6, d_model=64, n_heads=4, e_layers=2, d_layers=1, d_ff=128, moving_avg=3, factor=1, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=0, down_sampling_window=1, down_sampling_method=None, seg_len=48, num_workers=10, itrs=3, itr_no=None, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, des=None, loss='MSE', lradj='type1', gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, dry_run=False, percent=100, model='TimesNet', use_gpu=True, enc_in=5, dec_in=5, c_out=5, task_name='long_term_forecast')

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/TimesNet_sl_96_pl_48/1

Experiment begins at 2024-09-06 09:34:43

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 53.8 s | Train Loss: 3.7633 Vali Loss: 2.3034
Validation loss decreased (inf --> 2.303377).  Saving model ...
Epoch: 2 | Time: 56.3 s | Train Loss: 3.1501 Vali Loss: 2.0091
Validation loss decreased (2.303377 --> 2.009131).  Saving model ...
Epoch: 3 | Time: 55.4 s | Train Loss: 2.735 Vali Loss: 1.9824
Validation loss decreased (2.009131 --> 1.982376).  Saving model ...
Epoch: 4 | Time: 48.6 s | Train Loss: 2.3618 Vali Loss: 1.7937
Validation loss decreased (1.982376 --> 1.793699).  Saving model ...
Epoch: 5 | Time: 52.6 s | Train Loss: 2.0957 Vali Loss: 2.0539
EarlyStopping counter: 1 out of 3
Epoch: 6 | Time: 52.9 s | Train Loss: 1.6296 Vali Loss: 2.4607
EarlyStopping counter: 2 out of 3
Epoch: 7 | Time: 54.4 s | Train Loss: 1.3721 Vali Loss: 2.4282
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:41:01.
Model parameters: 9389525
Total memory: 11165.2 MB
Allocated memory: 167.5 MB
Max allocated memory: 1780.3 MB
Time per epoch: 54.0 sec.
Memory usage: Available 11165.2 MB, Allocated 167.5 MB, Max allocated 1780.3 MB

Loading model from results/Crude_Oil/TimesNet_sl_96_pl_48/1/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.4453, mae:0.90149
Upscaling data and removing negatives...
test -- mse:2.2381e+09, mae:15315, rmsle: 0.35564 smape 12.147


>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/TimesNet_sl_96_pl_48/2

Experiment begins at 2024-09-06 09:41:05

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 48.2 s | Train Loss: 3.7945 Vali Loss: 2.2257
Validation loss decreased (inf --> 2.225670).  Saving model ...
Epoch: 2 | Time: 52.5 s | Train Loss: 3.4477 Vali Loss: 2.3292
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 47.9 s | Train Loss: 2.9989 Vali Loss: 2.5714
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 47.6 s | Train Loss: 2.5985 Vali Loss: 2.5402
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:44:22.
Model parameters: 9389525
Total memory: 11165.2 MB
Allocated memory: 172.3 MB
Max allocated memory: 1784.8 MB
Time per epoch: 49.3 sec.
Memory usage: Available 11165.2 MB, Allocated 172.3 MB, Max allocated 1784.8 MB

Loading model from results/Crude_Oil/TimesNet_sl_96_pl_48/2/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:2.2573, mae:1.1677
Upscaling data and removing negatives...
test -- mse:2.3121e+09, mae:15377, rmsle: 0.36423 smape 13.785


>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/TimesNet_sl_96_pl_48/3

Experiment begins at 2024-09-06 09:44:27

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 24.5 s | Train Loss: 3.8473 Vali Loss: 1.8453
Validation loss decreased (inf --> 1.845319).  Saving model ...
Epoch: 2 | Time: 24.8 s | Train Loss: 2.9553 Vali Loss: 1.8511
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 24.9 s | Train Loss: 2.6148 Vali Loss: 2.2826
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 24.6 s | Train Loss: 2.0912 Vali Loss: 2.4872
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:46:07.
Model parameters: 9389525
Total memory: 11165.2 MB
Allocated memory: 169.5 MB
Max allocated memory: 1784.8 MB
Time per epoch: 25.0 sec.
Memory usage: Available 11165.2 MB, Allocated 169.5 MB, Max allocated 1784.8 MB

Loading model from results/Crude_Oil/TimesNet_sl_96_pl_48/3/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.5653, mae:0.95922
Upscaling data and removing negatives...
test -- mse:2.2387e+09, mae:15359, rmsle: 0.35566 smape 12.55

Running for model:iTransformer
NVIDIA GeForce GTX 1080 Ti
Args in experiment: Namespace(test=False, seed=2024, result_path='results', disable_progress=True, root_path='./data', data_path='Crude_Oil.csv', features='M', n_features=5, target='OT', freq='d', no_scale=False, seq_len=96, label_len=48, pred_len=48, top_k=5, num_kernels=6, d_model=64, n_heads=4, e_layers=2, d_layers=1, d_ff=128, moving_avg=3, factor=1, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=0, down_sampling_window=1, down_sampling_method=None, seg_len=48, num_workers=10, itrs=3, itr_no=None, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, des=None, loss='MSE', lradj='type1', gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, dry_run=False, percent=100, model='iTransformer', use_gpu=True, enc_in=5, dec_in=5, c_out=5, task_name='long_term_forecast')

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/iTransformer_sl_96_pl_48/1

Experiment begins at 2024-09-06 09:46:17

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 2.2 s | Train Loss: 3.9833 Vali Loss: 2.1923
Validation loss decreased (inf --> 2.192307).  Saving model ...
Epoch: 2 | Time: 1.72 s | Train Loss: 3.2044 Vali Loss: 2.194
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 1.78 s | Train Loss: 2.7734 Vali Loss: 2.6322
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 1.76 s | Train Loss: 2.3371 Vali Loss: 2.408
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:46:26.
Model parameters: 76400
Total memory: 11165.2 MB
Allocated memory: 17.7 MB
Max allocated memory: 20.6 MB
Time per epoch: 2.2 sec.
Memory usage: Available 11165.2 MB, Allocated 17.7 MB, Max allocated 20.6 MB

Loading model from results/Crude_Oil/iTransformer_sl_96_pl_48/1/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.0249, mae:0.78245
Upscaling data and removing negatives...
test -- mse:3.0069e+09, mae:19277, rmsle: 0.3947 smape 12.703


>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/iTransformer_sl_96_pl_48/2

Experiment begins at 2024-09-06 09:46:26

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 1.83 s | Train Loss: 4.0239 Vali Loss: 1.9485
Validation loss decreased (inf --> 1.948472).  Saving model ...
Epoch: 2 | Time: 2.11 s | Train Loss: 3.1745 Vali Loss: 2.1247
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 2.48 s | Train Loss: 2.5898 Vali Loss: 1.9663
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 2.48 s | Train Loss: 2.1376 Vali Loss: 2.2001
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:46:36.
Model parameters: 76400
Total memory: 11165.2 MB
Allocated memory: 17.7 MB
Max allocated memory: 20.6 MB
Time per epoch: 2.4 sec.
Memory usage: Available 11165.2 MB, Allocated 17.7 MB, Max allocated 20.6 MB

Loading model from results/Crude_Oil/iTransformer_sl_96_pl_48/2/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.223, mae:0.85733
Upscaling data and removing negatives...
test -- mse:2.7706e+09, mae:18247, rmsle: 0.35961 smape 12.7


>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/iTransformer_sl_96_pl_48/3

Experiment begins at 2024-09-06 09:46:36

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 2.47 s | Train Loss: 4.0541 Vali Loss: 1.6754
Validation loss decreased (inf --> 1.675394).  Saving model ...
Epoch: 2 | Time: 2.43 s | Train Loss: 3.251 Vali Loss: 2.3775
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 2.49 s | Train Loss: 2.7431 Vali Loss: 2.2732
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 2.44 s | Train Loss: 2.304 Vali Loss: 2.0244
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:46:47.
Model parameters: 76400
Total memory: 11165.2 MB
Allocated memory: 17.7 MB
Max allocated memory: 20.6 MB
Time per epoch: 2.6 sec.
Memory usage: Available 11165.2 MB, Allocated 17.7 MB, Max allocated 20.6 MB

Loading model from results/Crude_Oil/iTransformer_sl_96_pl_48/3/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.5151, mae:0.99436
Upscaling data and removing negatives...
test -- mse:2.7347e+09, mae:18003, rmsle: 0.36225 smape 13.632

NVIDIA GeForce GTX 1080 Ti
Args in experiment: Namespace(test=False, seed=2024, result_path='results', disable_progress=True, root_path='./data', data_path='Crude_Oil.csv', features='M', n_features=5, target='OT', freq='d', no_scale=False, seq_len=96, label_len=96, pred_len=48, top_k=5, num_kernels=6, d_model=64, n_heads=4, e_layers=2, d_layers=1, d_ff=128, moving_avg=3, factor=1, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=0, down_sampling_window=1, down_sampling_method=None, seg_len=48, num_workers=10, itrs=3, itr_no=None, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, des=None, loss='MSE', lradj='type1', gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, dry_run=False, percent=100, model='MICN', use_gpu=True, enc_in=5, dec_in=5, c_out=5, task_name='long_term_forecast')

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/MICN_sl_96_pl_48/1

Experiment begins at 2024-09-06 09:46:54

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 4.27 s | Train Loss: 4.2003 Vali Loss: 1.3293
Validation loss decreased (inf --> 1.329270).  Saving model ...
Epoch: 2 | Time: 2.67 s | Train Loss: 3.5508 Vali Loss: 1.6213
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 2.67 s | Train Loss: 3.2809 Vali Loss: 1.6227
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 2.69 s | Train Loss: 3.0777 Vali Loss: 1.8138
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:47:08.
Model parameters: 371829
Total memory: 11165.2 MB
Allocated memory: 23.4 MB
Max allocated memory: 51.7 MB
Time per epoch: 3.5 sec.
Memory usage: Available 11165.2 MB, Allocated 23.4 MB, Max allocated 51.7 MB

Loading model from results/Crude_Oil/MICN_sl_96_pl_48/1/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:0.94987, mae:0.79354
Upscaling data and removing negatives...
test -- mse:1.4485e+09, mae:13238, rmsle: 0.30309 smape 11.065


>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/MICN_sl_96_pl_48/2

Experiment begins at 2024-09-06 09:47:09

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 1.79 s | Train Loss: 4.1146 Vali Loss: 1.5332
Validation loss decreased (inf --> 1.533204).  Saving model ...
Epoch: 2 | Time: 1.77 s | Train Loss: 3.4565 Vali Loss: 1.6703
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 1.78 s | Train Loss: 3.2355 Vali Loss: 1.6208
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 1.83 s | Train Loss: 3.0109 Vali Loss: 1.8081
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:47:17.
Model parameters: 371829
Total memory: 11165.2 MB
Allocated memory: 23.4 MB
Max allocated memory: 51.7 MB
Time per epoch: 1.9 sec.
Memory usage: Available 11165.2 MB, Allocated 23.4 MB, Max allocated 51.7 MB

Loading model from results/Crude_Oil/MICN_sl_96_pl_48/2/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.0459, mae:0.80446
Upscaling data and removing negatives...
test -- mse:1.4046e+09, mae:13181, rmsle: 0.29194 smape 11.087


>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/MICN_sl_96_pl_48/3

Experiment begins at 2024-09-06 09:47:17

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 1.91 s | Train Loss: 4.0987 Vali Loss: 1.3525
Validation loss decreased (inf --> 1.352476).  Saving model ...
Epoch: 2 | Time: 2.05 s | Train Loss: 3.4286 Vali Loss: 1.6245
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 2.04 s | Train Loss: 3.2431 Vali Loss: 1.7988
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 2 s | Train Loss: 2.935 Vali Loss: 1.787
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:47:26.
Model parameters: 371829
Total memory: 11165.2 MB
Allocated memory: 23.4 MB
Max allocated memory: 51.7 MB
Time per epoch: 2.2 sec.
Memory usage: Available 11165.2 MB, Allocated 23.4 MB, Max allocated 51.7 MB

Loading model from results/Crude_Oil/MICN_sl_96_pl_48/3/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.0015, mae:0.80994
Upscaling data and removing negatives...
test -- mse:1.397e+09, mae:13068, rmsle: 0.28603 smape 11.21

NVIDIA GeForce GTX 1080 Ti
Args in experiment: Namespace(test=False, seed=2024, result_path='results', disable_progress=True, root_path='./data', data_path='Crude_Oil.csv', features='M', n_features=5, target='OT', freq='d', no_scale=False, seq_len=96, label_len=0, pred_len=48, top_k=5, num_kernels=6, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=3, factor=3, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', seg_len=48, num_workers=10, itrs=3, itr_no=None, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, des=None, loss='MSE', lradj='type1', gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, dry_run=False, percent=100, model='TimeMixer', use_gpu=True, enc_in=5, dec_in=5, c_out=5, task_name='long_term_forecast')

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/TimeMixer_sl_96_pl_48/1

Experiment begins at 2024-09-06 09:47:35

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 5.6 s | Train Loss: 4.3418 Vali Loss: 2.2712
Validation loss decreased (inf --> 2.271173).  Saving model ...
Epoch: 2 | Time: 5.09 s | Train Loss: 3.1631 Vali Loss: 2.3726
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 5.47 s | Train Loss: 2.5523 Vali Loss: 2.009
Validation loss decreased (2.271173 --> 2.008960).  Saving model ...
Epoch: 4 | Time: 5.48 s | Train Loss: 2.0489 Vali Loss: 1.6613
Validation loss decreased (2.008960 --> 1.661309).  Saving model ...
Epoch: 5 | Time: 5.33 s | Train Loss: 1.6662 Vali Loss: 2.3458
EarlyStopping counter: 1 out of 3
Epoch: 6 | Time: 5.29 s | Train Loss: 1.3011 Vali Loss: 2.0599
EarlyStopping counter: 2 out of 3
Epoch: 7 | Time: 5.34 s | Train Loss: 1.098 Vali Loss: 2.3725
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:48:14.
Model parameters: 95457
Total memory: 11165.2 MB
Allocated memory: 18.3 MB
Max allocated memory: 82.9 MB
Time per epoch: 5.7 sec.
Memory usage: Available 11165.2 MB, Allocated 18.3 MB, Max allocated 82.9 MB

Loading model from results/Crude_Oil/TimeMixer_sl_96_pl_48/1/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:2.0425, mae:1.0646
Upscaling data and removing negatives...
test -- mse:1.9523e+09, mae:14971, rmsle: 0.33874 smape 13.026


>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/TimeMixer_sl_96_pl_48/2

Experiment begins at 2024-09-06 09:48:15

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 4.7 s | Train Loss: 4.3731 Vali Loss: 1.9775
Validation loss decreased (inf --> 1.977540).  Saving model ...
Epoch: 2 | Time: 5.29 s | Train Loss: 3.3104 Vali Loss: 1.9467
Validation loss decreased (1.977540 --> 1.946725).  Saving model ...
Epoch: 3 | Time: 5.23 s | Train Loss: 2.678 Vali Loss: 1.7918
Validation loss decreased (1.946725 --> 1.791812).  Saving model ...
Epoch: 4 | Time: 4.95 s | Train Loss: 2.1257 Vali Loss: 1.7523
Validation loss decreased (1.791812 --> 1.752267).  Saving model ...
Epoch: 5 | Time: 4.67 s | Train Loss: 1.6477 Vali Loss: 1.8723
EarlyStopping counter: 1 out of 3
Epoch: 6 | Time: 4.51 s | Train Loss: 1.2827 Vali Loss: 2.0345
EarlyStopping counter: 2 out of 3
Epoch: 7 | Time: 5.14 s | Train Loss: 1.0501 Vali Loss: 1.9436
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:48:51.
Model parameters: 95457
Total memory: 11165.2 MB
Allocated memory: 18.3 MB
Max allocated memory: 82.9 MB
Time per epoch: 5.1 sec.
Memory usage: Available 11165.2 MB, Allocated 18.3 MB, Max allocated 82.9 MB

Loading model from results/Crude_Oil/TimeMixer_sl_96_pl_48/2/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:2.2449, mae:1.1554
Upscaling data and removing negatives...
test -- mse:2.0273e+09, mae:15272, rmsle: 0.34384 smape 13.871


>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/TimeMixer_sl_96_pl_48/3

Experiment begins at 2024-09-06 09:48:51

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 3.95 s | Train Loss: 4.6474 Vali Loss: 2.0988
Validation loss decreased (inf --> 2.098847).  Saving model ...
Epoch: 2 | Time: 3.87 s | Train Loss: 3.351 Vali Loss: 2.1024
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 4.11 s | Train Loss: 2.9493 Vali Loss: 2.6021
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 5.42 s | Train Loss: 2.6826 Vali Loss: 2.2942
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:49:09.
Model parameters: 95457
Total memory: 11165.2 MB
Allocated memory: 18.3 MB
Max allocated memory: 82.9 MB
Time per epoch: 4.5 sec.
Memory usage: Available 11165.2 MB, Allocated 18.3 MB, Max allocated 82.9 MB

Loading model from results/Crude_Oil/TimeMixer_sl_96_pl_48/3/checkpoint.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.3116, mae:0.88808
Upscaling data and removing negatives...
test -- mse:2.6093e+09, mae:17260, rmsle: 0.35869 smape 12.654

NVIDIA GeForce GTX 1080 Ti
Args in experiment: Namespace(test=False, seed=2024, result_path='results', disable_progress=True, root_path='./data', data_path='Crude_Oil.csv', features='M', n_features=5, target='OT', freq='d', no_scale=False, seq_len=96, label_len=48, pred_len=48, top_k=5, num_kernels=6, d_model=768, n_heads=4, e_layers=2, d_layers=1, d_ff=128, moving_avg=3, factor=1, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itrs=3, itr_no=None, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, des=None, loss='MSE', lradj='type1', gpu=0, use_multi_gpu=False, devices='0,1,2,3', dry_run=False, percent=100, model_id='ori', model='CALF', task_loss='l1', distill_loss='l1', logits_loss='l1', tmax=20, r=8, lora_alpha=32, lora_dropout=0.1, word_embedding_path='./utils/wte_pca_500.pt', task_w=1.0, feature_w=0.01, logits_w=1.0, gpt_layers=6, log_fine_name='CALF_result.txt', noise_scale=-100, bootstrap_eval=0, use_gpu=True, enc_in=5, dec_in=5, c_out=5, task_name='long_term_forecast')

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
model_id  ori
Experiments will be saved in results/Crude_Oil/CALF_sl_96_pl_48_id_ori/1

Experiment begins at 2024-09-06 09:49:26

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Loss function weights: 1.0 1.0 0.01
Orig-- ori
Epoch: 1 | Time: 7.34 s | Train Loss: 2.1401 Vali Loss: 1.618
Validation loss decreased (inf --> 1.618029).  Saving model ...
Epoch: 2 | Time: 5.88 s | Train Loss: 2.0628 Vali Loss: 1.5551
Validation loss decreased (1.618029 --> 1.555083).  Saving model ...
Epoch: 3 | Time: 6.03 s | Train Loss: 2.1026 Vali Loss: 1.8256
EarlyStopping counter: 1 out of 3
Epoch: 4 | Time: 5.46 s | Train Loss: 2.9369 Vali Loss: 1.8409
EarlyStopping counter: 2 out of 3
Epoch: 5 | Time: 6.15 s | Train Loss: 3.6762 Vali Loss: 2.0996
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:50:15.
Model parameters: 180070448
Total memory: 11165.2 MB
Allocated memory: 949.8 MB
Max allocated memory: 1254.8 MB
Time per epoch: 9.7 sec.
Memory usage: Available 11165.2 MB, Allocated 949.8 MB, Max allocated 1254.8 MB

Loading model from results/Crude_Oil/CALF_sl_96_pl_48_id_ori/1/llm.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.6446, mae:1.0317
Upscaling data and removing negatives...
test -- mse:3.2044e+09, mae:19167, rmsle: 0.37699 smape 13.994


>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
model_id  ori
Experiments will be saved in results/Crude_Oil/CALF_sl_96_pl_48_id_ori/2

Experiment begins at 2024-09-06 09:50:17

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Loss function weights: 1.0 1.0 0.01
Orig-- ori
Epoch: 1 | Time: 4.16 s | Train Loss: 2.2381 Vali Loss: 1.6318
Validation loss decreased (inf --> 1.631756).  Saving model ...
Epoch: 2 | Time: 6.01 s | Train Loss: 2.4444 Vali Loss: 2.4121
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 6.2 s | Train Loss: 3.1488 Vali Loss: 2.0121
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 5.75 s | Train Loss: 3.8451 Vali Loss: 1.8533
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:50:47.
Model parameters: 180070448
Total memory: 11165.2 MB
Allocated memory: 954.4 MB
Max allocated memory: 1640.8 MB
Time per epoch: 7.7 sec.
Memory usage: Available 11165.2 MB, Allocated 954.4 MB, Max allocated 1640.8 MB

Loading model from results/Crude_Oil/CALF_sl_96_pl_48_id_ori/2/llm.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.1154, mae:0.81484
Upscaling data and removing negatives...
test -- mse:2.6072e+09, mae:16563, rmsle: 0.36461 smape 11.808


>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
model_id  ori
Experiments will be saved in results/Crude_Oil/CALF_sl_96_pl_48_id_ori/3

Experiment begins at 2024-09-06 09:50:49

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Loss function weights: 1.0 1.0 0.01
Orig-- ori
Epoch: 1 | Time: 6.02 s | Train Loss: 2.1834 Vali Loss: 1.5582
Validation loss decreased (inf --> 1.558240).  Saving model ...
Epoch: 2 | Time: 5.64 s | Train Loss: 2.0766 Vali Loss: 1.6649
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 5.6 s | Train Loss: 2.0161 Vali Loss: 1.7706
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 6.13 s | Train Loss: 2.9235 Vali Loss: 1.5806
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:51:21.
Model parameters: 180070448
Total memory: 11165.2 MB
Allocated memory: 955.1 MB
Max allocated memory: 1643.8 MB
Time per epoch: 7.9 sec.
Memory usage: Available 11165.2 MB, Allocated 955.1 MB, Max allocated 1643.8 MB

Loading model from results/Crude_Oil/CALF_sl_96_pl_48_id_ori/3/llm.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.6686, mae:1.0239
Upscaling data and removing negatives...
test -- mse:2.7304e+09, mae:16953, rmsle: 0.37309 smape 13.224

NVIDIA GeForce GTX 1080 Ti
Args in experiment: Namespace(test=False, seed=2024, result_path='results', disable_progress=True, root_path='./data', data_path='Crude_Oil.csv', features='M', n_features=5, target='OT', freq='d', no_scale=False, seq_len=96, label_len=48, pred_len=48, top_k=5, num_kernels=6, d_model=768, n_heads=4, e_layers=2, d_layers=1, d_ff=128, moving_avg=3, factor=1, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itrs=3, itr_no=None, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, des=None, loss='MSE', lradj='type1', gpu=0, use_multi_gpu=False, devices='0,1,2,3', dry_run=False, percent=100, model_id='ori', model='OFA', gpt_layers=6, is_gpt=1, patch_size=16, kernel_size=25, pretrain=1, freeze=1, stride=8, max_len=-1, hid_dim=16, tmax=20, n_scale=-1, use_gpu=True, enc_in=5, dec_in=5, c_out=5, task_name='long_term_forecast')

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/OFA_sl_96_pl_48_id_ori/1

Experiment begins at 2024-09-06 09:51:32

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 4.95 s | Train Loss: 1.2648 Vali Loss: 1.0154
Validation loss decreased (inf --> 1.015433).  Saving model ...
Epoch: 2 | Time: 4.64 s | Train Loss: 1.1552 Vali Loss: 0.98285
Validation loss decreased (1.015433 --> 0.982852).  Saving model ...
Epoch: 3 | Time: 4.61 s | Train Loss: 1.1244 Vali Loss: 0.95874
Validation loss decreased (0.982852 --> 0.958738).  Saving model ...
Epoch: 4 | Time: 4.68 s | Train Loss: 1.0791 Vali Loss: 0.93624
Validation loss decreased (0.958738 --> 0.936237).  Saving model ...
Epoch: 5 | Time: 4.72 s | Train Loss: 1.0598 Vali Loss: 0.99751
EarlyStopping counter: 1 out of 3
Epoch: 6 | Time: 4.74 s | Train Loss: 1.0188 Vali Loss: 1.0841
EarlyStopping counter: 2 out of 3
Epoch: 7 | Time: 4.66 s | Train Loss: 0.97692 Vali Loss: 1.0432
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:52:22.
Model parameters: 82368048
Total memory: 11165.2 MB
Allocated memory: 353.4 MB
Max allocated memory: 1243.0 MB
Time per epoch: 7.1 sec.
Memory usage: Available 11165.2 MB, Allocated 353.4 MB, Max allocated 1243.0 MB

Loading model from results/Crude_Oil/OFA_sl_96_pl_48_id_ori/1/llm.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.2137, mae:0.84039
Upscaling data and removing negatives...
test -- mse:1.5402e+09, mae:13369, rmsle: 0.31139 smape 11.406


>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/OFA_sl_96_pl_48_id_ori/2

Experiment begins at 2024-09-06 09:52:23

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 4.76 s | Train Loss: 1.2685 Vali Loss: 1.0656
Validation loss decreased (inf --> 1.065565).  Saving model ...
Epoch: 2 | Time: 4.77 s | Train Loss: 1.1664 Vali Loss: 0.97008
Validation loss decreased (1.065565 --> 0.970082).  Saving model ...
Epoch: 3 | Time: 4.71 s | Train Loss: 1.1279 Vali Loss: 1.0014
EarlyStopping counter: 1 out of 3
Epoch: 4 | Time: 4.71 s | Train Loss: 1.0945 Vali Loss: 1.0642
EarlyStopping counter: 2 out of 3
Epoch: 5 | Time: 4.72 s | Train Loss: 1.0619 Vali Loss: 0.94638
Validation loss decreased (0.970082 --> 0.946379).  Saving model ...
Epoch: 6 | Time: 5 s | Train Loss: 1.0242 Vali Loss: 0.98996
EarlyStopping counter: 1 out of 3
Epoch: 7 | Time: 4.73 s | Train Loss: 0.98016 Vali Loss: 0.97127
EarlyStopping counter: 2 out of 3
Epoch: 8 | Time: 4.79 s | Train Loss: 0.95515 Vali Loss: 0.99361
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:53:13.
Model parameters: 82368048
Total memory: 11165.2 MB
Allocated memory: 354.2 MB
Max allocated memory: 1245.3 MB
Time per epoch: 6.3 sec.
Memory usage: Available 11165.2 MB, Allocated 354.2 MB, Max allocated 1245.3 MB

Loading model from results/Crude_Oil/OFA_sl_96_pl_48_id_ori/2/llm.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.6848, mae:0.99278
Upscaling data and removing negatives...
test -- mse:1.5349e+09, mae:13353, rmsle: 0.31455 smape 12.548


>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
Experiments will be saved in results/Crude_Oil/OFA_sl_96_pl_48_id_ori/3

Experiment begins at 2024-09-06 09:53:15

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 4.84 s | Train Loss: 1.2604 Vali Loss: 1.2124
Validation loss decreased (inf --> 1.212391).  Saving model ...
Epoch: 2 | Time: 5.01 s | Train Loss: 1.1726 Vali Loss: 0.96405
Validation loss decreased (1.212391 --> 0.964052).  Saving model ...
Epoch: 3 | Time: 4.75 s | Train Loss: 1.1373 Vali Loss: 0.98574
EarlyStopping counter: 1 out of 3
Epoch: 4 | Time: 4.97 s | Train Loss: 1.1103 Vali Loss: 0.98551
EarlyStopping counter: 2 out of 3
Epoch: 5 | Time: 4.72 s | Train Loss: 1.075 Vali Loss: 1.0285
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:53:47.
Model parameters: 82368048
Total memory: 11165.2 MB
Allocated memory: 354.3 MB
Max allocated memory: 1245.3 MB
Time per epoch: 6.4 sec.
Memory usage: Available 11165.2 MB, Allocated 354.3 MB, Max allocated 1245.3 MB

Loading model from results/Crude_Oil/OFA_sl_96_pl_48_id_ori/3/llm.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:0.93353, mae:0.75837
Upscaling data and removing negatives...
test -- mse:1.7508e+09, mae:14288, rmsle: 0.31564 smape 11.172

NVIDIA GeForce GTX 1080 Ti
Args in experiment: Namespace(test=False, seed=2024, result_path='results', disable_progress=True, root_path='./data', data_path='Crude_Oil.csv', features='M', n_features=5, target='OT', freq='d', no_scale=False, seq_len=96, label_len=48, pred_len=48, top_k=5, num_kernels=6, d_model=16, n_heads=4, e_layers=2, d_layers=1, d_ff=128, moving_avg=3, factor=1, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itrs=3, itr_no=None, train_epochs=10, batch_size=16, patience=3, learning_rate=0.001, des=None, loss='MSE', lradj='type1', gpu=0, use_multi_gpu=False, devices='0,1,2,3', dry_run=False, percent=100, model_id='ori', model='TimeLLM', patch_len=16, stride=8, prompt_domain=1, llm_model='GPT2', llm_dim=768, llm_layers=6, use_gpu=True, enc_in=5, dec_in=5, c_out=5, task_name='long_term_forecast', content='Crude Oil historical price per day in dollars')

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
description: Crude Oil historical price per day in dollars
Experiments will be saved in results/Crude_Oil/TimeLLM_sl_96_pl_48_id_ori/1

Experiment begins at 2024-09-06 09:54:04

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 62.8 s | Train Loss: 4.5303 Vali Loss: 1.5244
Validation loss decreased (inf --> 1.524391).  Saving model ...
Epoch: 2 | Time: 59.2 s | Train Loss: 4.022 Vali Loss: 1.6316
EarlyStopping counter: 1 out of 3
Epoch: 3 | Time: 59.6 s | Train Loss: 4.0201 Vali Loss: 1.7213
EarlyStopping counter: 2 out of 3
Epoch: 4 | Time: 59.4 s | Train Loss: 3.9081 Vali Loss: 1.6048
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 09:58:12.
Model parameters: 133434752
Total memory: 11165.2 MB
Allocated memory: 1126.9 MB
Max allocated memory: 6468.0 MB
Time per epoch: 62.1 sec.
Memory usage: Available 11165.2 MB, Allocated 1126.9 MB, Max allocated 6468.0 MB

Loading model from results/Crude_Oil/TimeLLM_sl_96_pl_48_id_ori/1/llm.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.151, mae:0.87011
Upscaling data and removing negatives...
test -- mse:2.7824e+09, mae:18572, rmsle: 0.36373 smape 13.465


>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
description: Crude Oil historical price per day in dollars
Experiments will be saved in results/Crude_Oil/TimeLLM_sl_96_pl_48_id_ori/2

Experiment begins at 2024-09-06 09:58:18

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 62.2 s | Train Loss: 4.5122 Vali Loss: 1.6932
Validation loss decreased (inf --> 1.693193).  Saving model ...
Epoch: 2 | Time: 60 s | Train Loss: 3.965 Vali Loss: 1.5291
Validation loss decreased (1.693193 --> 1.529129).  Saving model ...
Epoch: 3 | Time: 60.3 s | Train Loss: 3.9304 Vali Loss: 1.5882
EarlyStopping counter: 1 out of 3
Epoch: 4 | Time: 59.8 s | Train Loss: 3.9036 Vali Loss: 1.9602
EarlyStopping counter: 2 out of 3
Epoch: 5 | Time: 60.2 s | Train Loss: 3.7581 Vali Loss: 2.0367
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 10:03:33.
Model parameters: 133434752
Total memory: 11165.2 MB
Allocated memory: 1128.6 MB
Max allocated memory: 6468.6 MB
Time per epoch: 63.0 sec.
Memory usage: Available 11165.2 MB, Allocated 1128.6 MB, Max allocated 6468.6 MB

Loading model from results/Crude_Oil/TimeLLM_sl_96_pl_48_id_ori/2/llm.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.1081, mae:0.83645
Upscaling data and removing negatives...
test -- mse:2.6667e+09, mae:17961, rmsle: 0.35355 smape 12.67


>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
description: Crude Oil historical price per day in dollars
Experiments will be saved in results/Crude_Oil/TimeLLM_sl_96_pl_48_id_ori/3

Experiment begins at 2024-09-06 10:03:38

>>>>>>> start training :>>>>>>>>>>
train 1880
val 207
Epoch: 1 | Time: 62.6 s | Train Loss: 4.4198 Vali Loss: 1.7876
Validation loss decreased (inf --> 1.787619).  Saving model ...
Epoch: 2 | Time: 59.3 s | Train Loss: 4.1491 Vali Loss: 1.6055
Validation loss decreased (1.787619 --> 1.605536).  Saving model ...
Epoch: 3 | Time: 60.1 s | Train Loss: 3.9204 Vali Loss: 2.2971
EarlyStopping counter: 1 out of 3
Epoch: 4 | Time: 59.8 s | Train Loss: 3.8652 Vali Loss: 2.1521
EarlyStopping counter: 2 out of 3
Epoch: 5 | Time: 59.7 s | Train Loss: 3.7429 Vali Loss: 2.0949
EarlyStopping counter: 3 out of 3
Early stopping

Training completed at 2024-09-06 10:08:53.
Model parameters: 133434752
Total memory: 11165.2 MB
Allocated memory: 1128.4 MB
Max allocated memory: 6470.2 MB
Time per epoch: 62.9 sec.
Memory usage: Available 11165.2 MB, Allocated 1128.4 MB, Max allocated 6470.2 MB

Loading model from results/Crude_Oil/TimeLLM_sl_96_pl_48_id_ori/3/llm.pth

>>>>>>> testing :  <<<<<<<<<<<<<<<<<<<
test 205
Preds and Trues shape: (205, 48, 5) (205, 48, 5)
test scaled -- mse:1.0825, mae:0.82859
Upscaling data and removing negatives...
test -- mse:2.3738e+09, mae:16751, rmsle: 0.34582 smape 12.434

